#!/usr/bin/env python
# -*- coding: utf-8 -*-

from werkzeug.middleware.dispatcher import DispatcherMiddleware
from werkzeug.middleware.proxy_fix import ProxyFix
from werkzeug.middleware.http_proxy import ProxyMiddleware
from werkzeug.exceptions import NotFound

from app.wsgi import app as backend

app = ProxyMiddleware(
    DispatcherMiddleware(
        NotFound(), {
            "/api": backend
        }
    ), {
        "/": {
            "target": "http://localhost:5173/",
        }
    }
)

if __name__ == "__main__":
    from werkzeug.serving import run_simple
    run_simple("127.0.0.1", 8080, app, use_reloader=True, use_debugger=True)
